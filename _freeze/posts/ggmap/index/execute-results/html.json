{
  "hash": "08798cba1a1310f7e5e357d0335a1de9",
  "result": {
    "markdown": "---\ntitle: \"Making maps with `ggmap`\"\nauthor: \"Bradford Johnson\"\ndate: \"2022-11-14\"\ncategories: [ggmap, map]\nimage: \"edgar-moran-Ky9JHrdvb1o-unsplash.jpg\"\ncode-fold: false\n---\n\n\n::: column-page\n## How to create maps with `ggmap`\n\nThe `ggmap` package makes life easier when you are trying to visualize geographic data.\n\nIt connects the `ggplot2` framework with mapping services allowing the user to create *powerful* and *insightful* maps.\n\n<p>\n\n</p>\n\n### What kind of map will I be making?\n\nI will be working with crime data from the *City of Atlanta Police Department*. For this analysis I will use the 2021 crime data and I want to visualize the reported homicides.\n\n### R packages\n\nI will be using the [`tidyverse`](https://tidyverse.tidyverse.org/), [`ggmap`](https://www.rdocumentation.org/packages/ggmap/), [`ggdensity`](https://jamesotto852.github.io/ggdensity/) and [`geomtextpath`](https://www.rdocumentation.org/packages/geomtextpath/) packages. Below you can view the documentation for the respective package.\n\n| **Package**  | **Documentation**                                                                                     |\n|--------------|-------------------------------------------------------------------------------------------------------|\n| *tidyverse*  | [tidyverse.tidyverse.org](https://tidyverse.tidyverse.org/)                                           |\n| *ggmap*      | [www.rdocumentation.org/packages/ggmap](https://www.rdocumentation.org/packages/ggmap/)               |\n| *ggdensity*  | [jamesotto852.github.io/ggdensity](https://jamesotto852.github.io/ggdensity/)                         |\n| *ggtextpath* | [www.rdocumentation.org/packages/geomtextpath](https://www.rdocumentation.org/packages/geomtextpath/) |\n\n<p>\n\n</p>\n\nIf you are missing any of these package then use this code to install them.\n\n``` r\ninstall.packages(\"tidyverse\")\ninstall.packages(\"ggmap\")\ninstall.packages(\"ggdensity\")\ninstall.packages(\"geomtextpath\")\n```\n\nOnce you have everything installed load the packages.\n\n> *You have to load the packages each time you use them, but you only have to install them once*\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggmap)\nlibrary(ggdensity)\nlibrary(geomtextpath)\n```\n:::\n\n\n<p>\n\n</p>\n\n### The data\n\n> -   [Click here](https://www.atlantapd.org/i-want-to/crime-data-downloads) to see all of the available Atlanta crime data\n>\n> -   [Click here](https://www.atlantapd.org/home/showpublisheddocument/4576/637770569750770000) to download the 2021 Atlanta crime data\n\nOnce you have the data you want to use then load it into R.\n\n> *I downloaded the 2021 Atlanta crime data, cleaned the column names, filtered for only homicide reports, and only kept these columns:*\\\n> - *`offense_id`*\\\n> - *`lat`*\\\n> - *`long`*\n\n<p>\n\n</p>\n\nMy data is in my working directory named '*atl-homicides-2021.csv*', I can use the `read_csv()` function from the `readr` package (included in tidyverse) and turn the `.csv` file into a data frame within R. I will name this data frame `cobra_df`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncobra_df <- read_csv(\"atl-homicides-2021.csv\")\n```\n:::\n\n\n<p>\n\n</p>\n\nNext I will create a simple map that shows the general location of each reported homicide. Each reported homicide location will be marked with a red circle.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_1 <- qmplot(long, lat, data = cobra_df,\n                source = \"osm\", maptype = \"roadmap\",\n                color = I(\"red\"))\n\nmap_1\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n<p>\n\n</p>\n\nNow I want to look deeper and create a 2D density plot, using the `geom_hdr()` function from the `ggdensity` package allows me to **perform 2D density estimation**. The `geomtextpath` package creates the labels, and in this case I am creating labels on the map that correspond to the *probabilities* for a reported homicide within the respective *contoured region*.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmap_2 <- qmplot(long, lat, data = cobra_df, geom = \"blank\", \n       zoom = 14, source = \"osm\", maptype = \"roadmap\") +\n  geom_hdr(aes(fill = stat(probs)), alpha = .3) +\n  geom_labeldensity2d(aes(long, lat, level = stat(probs)), stat = \"hdr_lines\") +\n  scale_fill_viridis_d(option = \"A\") +\n  theme(legend.position = \"none\")\n\nmap_2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n<p>\n\n</p>\n\n### What did I learn from this?\n\nWhen I was new to **R** my favorite learning activity was to try and create crime \"heatmaps\" with Atlanta's crime data. Now over *1 year later* revisiting this was a good change of pace. I was able to learn about these packages and figure out how to actually extract insights from geographic data (*rather than just making cool looking maps*).\n\n<p>\n\n</p>\n\n### **Bonus!**\n\n> *For some insight on how my mapping skills have changed over time*\n\nHere is a picture of the **first map** I created in **R** on May 5th, 2021.\n\n![](first-r-map.png)\n\nThis map took many hours to make, and shows Atlanta's reported homicides from 2009-2020 including some of 2021's preliminary data.\n\n<p>\n\n</p>\n\n### Contact me\n\nReach out to me if you have any **feedback**, **questions**, or **suggestions**! I am open to collaborating with others on projects and expanding my network! Until next post!\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}